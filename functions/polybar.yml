---
- hosts: all
  tasks:
  - name: ensure polybar is installed at the latest version
    become: yes
    package: name=polybar state=latest
  # configuration
  - name: ensure the i3 directory exists
    ansible.builtin.file:
      path: "{{ ansible_env.HOME }}/.config/i3"
      state: directory
  - name: copy the config
    template: src=../config/configuration/polybar.tpl dest={{ ansible_env.HOME  }}/.config/i3/polybar.conf
  - name: ensure the i3 bin directory exists
    ansible.builtin.file:
      path: "{{ ansible_env.HOME }}/.config/i3/bin"
      state: directory
  - name: copy the wrapper script for i3
    template: src=../config/scripts/run_polybar.tpl dest={{ ansible_env.HOME  }}/.config/i3/bin/run_polybar.sh
  - name: ensure file that the script has the right permisions
    file: path={{ ansible_env.HOME }}/.config/i3/bin/run_polybar.sh owner={{ ansible_env.USERNAME }} group={{ ansible_env.USERNAME }} mode=0755

